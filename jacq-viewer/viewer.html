<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
    "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" >

 <head>
  <meta name="author" content="Ruven Pillay &lt;ruven@users.sourceforge.netm&gt;"/>
  <meta name="author" content="Ryan Chute &lt;rchute@users.sourceforge.netm&gt;"/>
  <meta name="keywords" content="djatoka IIPImage Ajax IIP Zooming Streaming High Resolution Mootools"/>
  <meta name="description" content="djatoka IIPImage Viewer: High Resolution Remote Image Streaming Viewing"/>
  <meta name="copyright" content="&copy; 2003-2008 Ruven Pillay"/>

  <link rel="stylesheet" type="text/css" media="all" href="css/iip.compressed.css" />
  <link rel="shortcut icon" href="images/djatoka.16x16.png" />
  <title>djatoka Viewer, based on IIPMooViewer 1.1</title>

  <script type="text/javascript" src="javascript/mootools-1.2-core-compressed.js"></script>
  <script type="text/javascript" src="javascript/mootools-1.2-more-compressed.js"></script>
  <script type="text/javascript" src="javascript/iipmooviewer-1.1.js"></script>
  
  <script type="text/javascript">
      // Simple function for changing the location once a new item was selected
      function identifier_select_onchange() {
          window.location = 'viewer.html?rft_id=' + $( 'identifier_select' ).get( 'value' ) + '&identifiers=' + identifiers.join(',');
      }
  </script>
 </head>

 <body>
     <div style="position: absolute; top: 10px; left: 10px; width: 150px; color: #FFFFFF; z-index: 1000;">
         <select id="identifier_select" onchange="identifier_select_onchange();"></select>
     </div>
   <div style="width:99%;height:99%;margin-left:auto;margin-right:auto" id="targetframe"></div>

  <script type="text/javascript">
    // The iipsrv server path (/fcgi-bin/iipsrv.fcgi by default)
    var server = '../adore-djatoka/resolver';

    // The *full* image path on the server. This path does *not* need to be in the web
    // server root directory. On Windows, use Unix style forward slash paths without
    // the "c:" prefix
    var images = 'http://memory.loc.gov/gmd/gmd433/g4330/g4330/np000066.jp2';

    // Copyright or information message
    var credit = '';
    
    // Global variable for holding the passed identifiers
    var identifiers = [];
    
    // Obtain URL Parameters if present
    var query = location.href.substring(location.href.indexOf("?")+1);
    var vars = query.split("&");
    for (var i=0;i<vars.length;i++) {
      var pair = vars[i].split("=");
      
      switch( pair[0] ) {
          case 'rft_id':
              images = pair[1];
              break;
          case 'identifiers':
              identifiers = pair[1].split(',');
              break;
      }
    }
    
    // Create drop-down entries for identifiers
    var selectEl = $( 'identifier_select' );
    for( var i = 0; i < identifiers.length; i++ ) {
        // Create new option element
        var optionEl = new Element( 'option', { value: identifiers[i], html: identifiers[i] } );
        // inject option element into select
        optionEl.inject(selectEl);
    }
    // Set correct value as selected 
    selectEl.set( 'value', images );
    
    // Create our viewer object - note: must assign this to the 'iip' variable.
    // See documentation for more details of options
    iip = new IIP( "targetframe", {
		image: images,
		server: server,
		credit: credit, 
		zoom: 1,
		render: 'random',
        showNavButtons: true
    });

  </script>
 </body>
</html>
